(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-2d0b16d2"],{2097:function(e,t,a){"use strict";a.r(t);a("20d6");var r=a("e814"),o=a.n(r),i=(a("55dd"),a("c5f6"),a("7f7f"),a("ac6a"),a("f499")),s=a.n(i),n=a("cebc"),d=a("bd86"),c=(a("cadf"),a("551c"),a("097d"),a("d8af"),a("2f62")),l=a("7e79"),u=a("5990"),h={data:function(){var e;return{clickData:"",rules:{name:[{required:!0,message:"请输入收藏名称",trigger:"blur"}],share_ctr:[{required:!0,message:"请设置是否共享",trigger:"blur"}]},boardForm:(e={name:"",share_ctr:0,sort:0,add_time:"",board_record:"",follow_num:"",id:"",isShow:""},Object(d.a)(e,"name",""),Object(d.a)(e,"share_num",""),Object(d.a)(e,"user_id",""),e),addBoardTitle:"添加收藏",addBoardShow:!1,currentPage:1,pageSize:100,countNum:0,searchValue:"",imgList:[],contentHeight:"height:"+(window.innerHeight-180)+"px"}},computed:Object(n.a)({},Object(c.e)("d2admin/user",["info"])),created:function(){window.ue?(this.navigationType="ue",this.needOverHeight=60):(this.navigationType="web",this.needOverHeight=0),this.$task.setnav("",this),this.getAllboard(),this.contentHeight="height:"+(window.innerHeight-180+this.needOverHeight)+"px"},mounted:function(){window.addEventListener("resize",this.getHeight)},beforeDestroy:function(){},destroyed:function(){window.removeEventListener("resize",this.getHeight)},components:{VueCropper:l.VueCropper},watch:{},methods:{toBack:function(){if(window.history.length<=1)return this.$router.push({path:"/assetsLibrary"}),!1;this.$router.go(-1)},toFollow:function(e){var t=this,a={drawing_board_id:e.id};Object(u.g)(a).then(function(a){t.$message({type:"success",message:"关注成功"}),e.isHeart=!0})},toCancleFollow:function(e){var t=this,a={drawing_board_id:e.id};Object(u.p)(a).then(function(a){t.$message({type:"success",message:"取消成功"}),e.isHeart=!1})},toClickImg:function(e){this.$router.push({path:"/details",query:{id:e.id,type:"flow",isShare:e.share_ctr}})},getAllboard:function(){var e=this,t={user_id:s()([this.info.userDetails.id]),position:(this.currentPage-1)*this.pageSize,length:this.pageSize};Object(u.G)(t).then(function(t){void 0==t.data?(e.imgList=[],e.countNum=0):(e.$task.arrSortForObj(t.data,"sort","desc"),t.data.forEach(function(t){if(t.board_record=null==t.board_record||""==t.board_record?[]:t.board_record,null!=t.board_record||""!=t.board_record){t.board_record.forEach(function(t){var a="",r="",o="";switch(t.is_type){case"0":case"1":case"2":case"3":a=t.id,r=e.$task.imgurl+"/assets/"+t.thum,o=t.name}void 0!=t.assets_play&&0!=t.assets_play.length&&(a=t.assets_play[0].id,r=e.$task.imgurl+t.assets_play[0].www_path+t.assets_play[0].server_path,o=t.assets_play[0].server_name),t.thumid=a,t.thumthum=r,t.thumname=o});for(var a=4-t.board_record.length,r=0;r<a;r++)t.board_record.push({thumid:0,thumthum:"",thumname:""})}t.isShow=!1,t.isHeart=!0}),e.imgList=t.data,e.countNum=Number(t.count))})},toEditBoard:function(e){this.boardForm=JSON.parse(s()(e)),this.addBoardTitle="修改收藏",this.addBoardShow=!0},toDeleteBoard:function(e,t){var a=this;this.$confirm("确认删除该收藏？").then(function(r){var o={id:e.id};Object(u.o)(o).then(function(e){a.$message({type:"success",message:"删除成功"}),a.imgList.splice(t,1)})}).catch(function(e){})},imgMouseOver:function(e){e.isShow=!0},imgMouseLeave:function(e){e.isShow=!1},addBoardclose:function(){this.boardForm.name="",this.boardForm.share_ctr=0,this.boardForm.sort=0,this.boardForm.add_time="",this.boardForm.board_record="",this.boardForm.follow_num="",this.boardForm.id="",this.boardForm.isShow="",this.boardForm.name="",this.boardForm.share_num="",this.boardForm.user_id="",this.addBoardTitle="添加收藏",this.addBoardShow=!1},submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(e)if("添加收藏"==t.addBoardTitle){var a={name:t.boardForm.name,share_ctr:t.boardForm.share_ctr,sort:t.boardForm.sort};Object(u.f)(a).then(function(e){var a=o()((new Date).getTime()/1e3),r={id:e.id,name:t.boardForm.name,share_ctr:t.boardForm.share_ctr,board_record:[],sort:t.boardForm.sort,add_time:a,user_id:t.info.userDetails.name,follow_num:0,share_num:0};t.imgList.push(r),t.$message({type:"success",message:"添加成功"}),t.addBoardclose()})}else{var r={id:t.boardForm.id,name:t.boardForm.name,share_ctr:t.boardForm.share_ctr,sort:t.boardForm.sort};Object(u.K)(r).then(function(e){var a=t;var r=t.imgList.findIndex(function(e){return e.id==a.boardForm.id});-1!=r&&(t.imgList[r].name=t.boardForm.name,t.imgList[r].share_ctr=t.boardForm.share_ctr,t.imgList[r].sort=t.boardForm.sort),t.$message({type:"success",message:"修改成功"}),t.addBoardclose()})}})},toAddBoard:function(){this.addBoardTitle="添加收藏",this.addBoardShow=!0},currentChange:function(){""==this.searchValue||this.searchValue,this.getAllboard(),document.body.scrollTop=document.documentElement.scrollTop=0},sizeChange:function(e){this.pageSize=e,""==this.searchValue||this.searchValue,this.getAllboard(),document.body.scrollTop=document.documentElement.scrollTop=0},handleSearchChange:function(e){this.getAllboard()},getHeight:function(){this.contentHeight="height:"+(window.innerHeight-180+this.needOverHeight)+"px"}}},m=a("2877"),g=Object(m.a)(h,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("d2-container",[a("div",[a("div",{ref:"imgBoxTopStyle",staticClass:"imgBoxTopStyle"},[a("div",[a("div",{staticClass:"topTips",staticStyle:{padding:"unset","background-color":"#252423"}},[a("el-row",[a("el-col",{staticClass:"modelTitle",attrs:{span:24}},[a("div",{staticClass:"selectBox",staticStyle:{background:"#2d2c2c"}},[a("div",{staticClass:"imgInput"},[a("el-input",{staticStyle:{width:"50%","vertical-align":"top"},attrs:{placeholder:"请输入内容",size:"mini",clearable:""},on:{change:e.handleSearchChange},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleSearchChange(t)}},model:{value:e.searchValue,callback:function(t){e.searchValue=t},expression:"searchValue"}})],1),a("div",[a("div",{staticClass:"settingSelectStyle"},[a("span",{staticStyle:{"margin-right":"15px",color:"#e0e0e0","font-size":"14px",cursor:"pointer"},on:{click:e.toBack}},[a("i",{staticClass:"el-icon-back"}),e._v("\n                      返回\n                    ")])])])]),a("div",{ref:"waterfallBox",staticStyle:{position:"relative"}},[a("el-row",[a("el-col",{attrs:{span:24}},[a("div",{ref:"waterfall",staticClass:"waterfall-height-js imgBoxStyle boardBoxStyle",style:e.contentHeight},[a("div",[0==e.imgList.length?a("div",{staticClass:"noDataBoxStyle1"},[a("span",[e._v(" 暂无数据 ")])]):e._l(e.imgList,function(t,r){return a("div",{key:r,staticClass:"boardimgBoxStyle",on:{click:function(a){return e.toClickImg(t)},mouseover:function(a){return e.imgMouseOver(t)},mouseleave:function(a){return e.imgMouseLeave(t)}}},[t.isShow?a("div",{staticClass:"moveMask"}):e._e(),"1"==t.share_ctr?a("div",{staticClass:"isshare_ctrStyle"},[a("span",{staticStyle:{color:"#e0e0e0"}},[e._v("共享")])]):e._e(),t.isShow?a("div",{staticClass:"editBoardStyle"},[t.isHeart?a("span",{on:{click:function(a){return a.stopPropagation(),e.toCancleFollow(t)}}},[a("d2-icon",{staticStyle:{"font-weight":"700"},attrs:{name:"heart"}})],1):a("span",{on:{click:function(a){return a.stopPropagation(),e.toFollow(t)}}},[a("d2-icon",{staticStyle:{"font-weight":"700","margin-left":"10px"},attrs:{name:"heart-o"}})],1),e.info.userDetails.id==t.user_id?a("span",{on:{click:function(a){return a.stopPropagation(),e.toEditBoard(t)}}},[a("d2-icon",{staticStyle:{"font-weight":"700","margin-left":"10px"},attrs:{name:"pencil"}})],1):e._e()]):e._e(),a("div",{staticStyle:{width:"240px",height:"240px","border-radius":"13px",overflow:"hidden"}},e._l(t.board_record,function(e,t){return a("div",{key:t,class:0==t?"boardImgBig":"boardImgSmall"},[""!=e.thumthum?a("img",{attrs:{src:e.thumthum,alt:""}}):a("div")])}),0),a("div",{staticClass:"boardimgname"},[e._v(e._s(t.name))]),a("div",{staticClass:"boardimgname boardimgTips"},[e._v("\n                            "+e._s(t.share_num)+" 共享 "+e._s(t.follow_num)+" 关注\n                            "),a("span",{staticStyle:{float:"right"}},[e._v(e._s(t.personnel_name))])])])})],2)]),a("div",{staticClass:"imgPagination"},[a("el-pagination",{staticStyle:{display:"inline-block"},attrs:{"current-page":e.currentPage,"page-sizes":[100,200,300,400,500],"page-size":e.pageSize,layout:"sizes, prev, pager, next, jumper,total,slot",total:e.countNum},on:{"size-change":e.sizeChange,"current-change":e.currentChange,"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t}}})],1)])],1)],1)])],1)],1)])])]),a("el-dialog",{staticClass:"boardDia",attrs:{title:e.addBoardTitle,visible:e.addBoardShow,width:"400px","close-on-click-modal":!1},on:{"update:visible":function(t){e.addBoardShow=t},close:e.addBoardclose}},[a("div",{},[a("el-form",{ref:"boardForm",attrs:{"label-position":"top",model:e.boardForm,rules:e.rules}},[a("el-form-item",{attrs:{label:"收藏名称",prop:"name"}},[a("el-input",{attrs:{size:"small"},model:{value:e.boardForm.name,callback:function(t){e.$set(e.boardForm,"name",t)},expression:"boardForm.name"}})],1),a("el-form-item",{attrs:{label:"共享开关",prop:"share_ctr"}},[a("el-switch",{attrs:{"active-value":"1","inactive-value":"0",size:"small"},model:{value:e.boardForm.share_ctr,callback:function(t){e.$set(e.boardForm,"share_ctr",t)},expression:"boardForm.share_ctr"}})],1),a("el-form-item",{attrs:{label:"排序"}},[a("el-input",{attrs:{size:"small"},model:{value:e.boardForm.sort,callback:function(t){e.$set(e.boardForm,"sort",t)},expression:"boardForm.sort"}})],1)],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.submitForm("boardForm")}}},[e._v("确认")])],1)])],1)},[],!1,null,null,null);g.options.__file="flow.vue";t.default=g.exports}}]);